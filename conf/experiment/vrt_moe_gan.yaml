# @package _global_
defaults:
  - override /train: gan
  - override /train/model: baby_vrt_moe

train:
  model:
    _target_: moe.MoEVRT.fastmoe.vrt_moe.TinyVRT
    num_experts: 4
    num_gpus: 1
    top_k: 2
    window_size: [ 8, 8, 8 ]
    refine_blocks: 3
    refine_steps: 5

  data:
    batch_size: 8
    datasets:
      train:
        seq: 8

  ddp: False
  max_epochs: 1000000
  num_grad_acc: 4

  perceptual_loss:
    _target_: core.losses.OpticalFlowConsistency
    weight: 1e-2

  adversarial_loss:
    weight: 1e-5

  restore: '/home/aghinassi/Desktop/nn-lab/storage/video-super-resolution/awefwuye/checkpoint/last.ckpt'